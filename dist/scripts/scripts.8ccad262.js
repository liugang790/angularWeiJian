angular.module("WeiJianAppFilter",[]).filter("ProductFilter",function(){return function(a,b,c,d,e){function f(a){return b&&"全部"!=b&&"产品类型"!=b?a.p_type==b:!0}function g(a){return c&&"全部"!=c&&"出发地"!=c?a.src==c:!0}function h(a){return d&&"全部"!=d&&"目的地"!=d?a.dst==d:!0}function i(a){return e&&"全部"!=e&&"出发时间"!=e?a.off_time==e:!0}return console.log(a,b,c,d,e),a?(console.log(a.filter(f).filter(g).filter(h).filter(i)),a.filter(f).filter(g).filter(h).filter(i)):void 0}}),function(a,b){"use strict";var c=function(){return!1}(),d=function(a,b){return c?['<div class="_720kb-datepicker-calendar-header">','<div class="_720kb-datepicker-calendar-header-middle _720kb-datepicker-mobile-item _720kb-datepicker-calendar-month">','<select ng-model="month" title="{{ dateMonthTitle }}" ng-change="selectedMonthHandle(month)">','<option ng-repeat="item in months" ng-selected="month === item" ng-disabled=\'!isSelectableMaxDate(item + " " + day + ", " + year) || !isSelectableMinDate(item + " " + day + ", " + year)\' ng-value="item">',"{{ item }}","</option>","</select>","</div>","</div>",'<div class="_720kb-datepicker-calendar-header">','<div class="_720kb-datepicker-calendar-header-middle _720kb-datepicker-mobile-item _720kb-datepicker-calendar-month">','<select ng-model="mobileYear" title="{{ dateYearTitle }}" ng-change="setNewYear(mobileYear)">','<option ng-repeat="item in paginationYears" ng-selected="year === item" ng-value="item" ng-disabled="!isSelectableMinYear(item) || !isSelectableMaxYear(item)">',"{{ item }}","</option>","</select>","</div>","</div>"]:['<div class="_720kb-datepicker-calendar-header">','<div class="_720kb-datepicker-calendar-header-left">','<b href="javascript:void(0)" ng-click="prevMonth()" title="{{ buttonPrevTitle }}">',a,"</b>","</div>",'<div class="_720kb-datepicker-calendar-header-middle _720kb-datepicker-calendar-month">',"{{year}}年 ","<span>","{{monthNumber}}月","</span>","</b>","</div>",'<div class="_720kb-datepicker-calendar-header-right">','<b href="javascript:void(0)" ng-click="nextMonth()" title="{{ buttonNextTitle }}">',b,"</b>","</div>","</div>"]},e=function(a,b){return['<div class="_720kb-datepicker-calendar-header" ng-show="showYearsPagination">','<div class="_720kb-datepicker-calendar-years-pagination">','<a ng-class="{\'_720kb-datepicker-active\': y === year, \'_720kb-datepicker-disabled\': !isSelectableMaxYear(y) || !isSelectableMinYear(y)}" href="javascript:void(0)" ng-click="setNewYear(y)" ng-repeat="y in paginationYears">',"{{y}}","</a>","</div>",'<div class="_720kb-datepicker-calendar-years-pagination-pages">','<a href="javascript:void(0)" ng-click="paginateYears(paginationYears[0])" ng-class="{\'_720kb-datepicker-item-hidden\': paginationYearsPrevDisabled}">',a,"</a>",'<a href="javascript:void(0)" ng-click="paginateYears(paginationYears[paginationYears.length -1 ])" ng-class="{\'_720kb-datepicker-item-hidden\': paginationYearsNextDisabled}">',b,"</a>","</div>","</div>"]},f=function(){return['<div class="_720kb-datepicker-calendar-days-header">','<div ng-repeat="d in daysInString">',"{{d}}","</div>","</div>"]},g=function(){return['<div class="_720kb-datepicker-calendar-body">','<a href="javascript:void(0)" ng-repeat="px in prevMonthDays" class="_720kb-datepicker-calendar-day">',"{{px}}","</a>",'<a href="javascript:void(0)" ng-repeat="item in days" ng-click="setDatepickerDay(item)" ng-class="{\'_720kb-datepicker-active\': day === item, \'_720kb-datepicker-disabled\': !isPriceDay(year, monthNumber, item)}" class="_720kb-datepicker-calendar-day">',"{{item}}",'<span  class="price">{{priceOnDay(item)}}</span>',"</a>",'<a href="javascript:void(0)" ng-repeat="nx in nextMonthDays" class="_720kb-datepicker-calendar-day">',"{{nx}}","</a>","</div>"]},h=function(a,b){var c=['<div class="_720kb-datepicker-calendar" ng-blur="hideCalendar()">',"</div>"],h=d(a,b),i=e(a,b),j=f(),k=g(),l=function(a){c.splice(c.length-1,0,a)};return h.forEach(l),i.forEach(l),j.forEach(l),k.forEach(l),c.join("")},i=function(b,d,e,f,g){var i=function(i,j,k){var l,m,n=(k.selector,j),o='<i class="iconfont left">&#xe628;</i>',p='<i class="iconfont right">&#xe600;</i>',q=k.buttonPrev||o,r=k.buttonNext||p,s=(k.dateFormat,i.dateDisabledDates),t=new Date,u=f("date")(t,"M"),v=!1,w=!1,x=e.DATETIME_FORMATS,y=h(q,r),z=function(){i.month=f("date")(new Date(i.dateMinLimit),"MMMM"),i.monthNumber=Number(f("date")(new Date(i.dateMinLimit),"MM")),i.day=Number(f("date")(new Date(i.dateMinLimit),"dd")),i.year=Number(f("date")(new Date(i.dateMinLimit),"yyyy"))},A=function(){i.month=f("date")(new Date(i.dateMaxLimit),"MMMM"),i.monthNumber=Number(f("date")(new Date(i.dateMaxLimit),"MM")),i.day=Number(f("date")(new Date(i.dateMaxLimit),"dd")),i.year=Number(f("date")(new Date(i.dateMaxLimit),"yyyy"))},B=function(){i.year=Number(i.year)-1},C=function(){i.year=Number(i.year)+1},D=function(){return i.isSelectableMinDate(i.year+"/"+i.monthNumber+"/"+i.day)&&i.isSelectableMaxDate(i.year+"/"+i.monthNumber+"/"+i.day)?(i.day<10&&(i.day="0"+i.day),i.pickedDate=i.year+"-"+i.monthNumber+"-"+i.day,i.$parent.changePrice(i.pickedDate),void 0):!1},E={add:function(a,b){var c;a.className.indexOf(b)>-1||(c=a.className.split(" "),c.push(b),a.className=c.join(" "))},remove:function(a,b){var c,d;if(-1!==a.className.indexOf(b)){for(d=a.className.split(" "),c=0;c<d.length;c+=1)if(d[c]===b){d=d.slice(0,c).concat(d.slice(c+1));break}a.className=d.join(" ")}}},F=function(){m=b.document.getElementsByClassName("_720kb-datepicker-calendar"),a.forEach(m,function(a,b){m[b].classList?m[b].classList.remove("_720kb-datepicker-open"):E.remove(m[b],"_720kb-datepicker-open")}),l.classList?l.classList.add("_720kb-datepicker-open"):E.add(l,"_720kb-datepicker-open")},G=function(a,b){var c,d,e,f,g=new Date(b,a,0).getDate(),h=new Date(b+"/"+a+"/1").getDay(),j=new Date(b+"/"+a+"/"+g).getDay(),k=[],l=[];for(i.days=[],c=1;g>=c;c+=1)i.days.push(c);if(0===h)i.prevMonthDays=[];else{for(e=h,f=1===Number(a)?12:a-1,c=1;c<=new Date(b,f,0).getDate();c+=1)k.push(c);i.prevMonthDays=k.slice(-e)}if(6>j){for(d=6-j,c=1;d>=c;c+=1)l.push(c);i.nextMonthDays=l}else i.nextMonthDays=[]},H=i.$watch("dateSet",function(a){console.log(a),a&&(t=new Date(a),i.month=f("date")(t,"MMMM"),i.monthNumber=Number(f("date")(t,"MM")),i.day=Number(f("date")(t,"dd")),i.year=Number(f("date")(t,"yyyy")),G(i.monthNumber,i.year),"true"!==i.dateSetHidden&&D())});i.nextMonth=function(){var a=new Date;12*a.getFullYear()+a.getMonth()+2<i.monthNumber+12*i.year||(12===i.monthNumber?(i.monthNumber=1,C()):i.monthNumber+=1,i.month=f("date")(new Date(i.year,i.monthNumber-1),"MMMM"),G(i.monthNumber,i.year),i.dateMaxLimit&&u>i.monthNumber&&(i.isSelectableMaxDate(i.year+"/"+i.monthNumber+"/"+i.day)||A()),i.day=void 0)},i.prevMonth=function(){var a=new Date;12*a.getFullYear()+a.getMonth()>=i.monthNumber+12*i.year-1||(1===i.monthNumber?(i.monthNumber=12,B()):i.monthNumber-=1,i.month=f("date")(new Date(i.year,i.monthNumber-1),"MMMM"),G(i.monthNumber,i.year),i.dateMinLimit&&(i.isSelectableMinDate(i.year+"/"+i.monthNumber+"/"+i.day)||z()),i.day=void 0)},i.selectedMonthHandle=function(a){i.monthNumber=Number(f("date")(new Date("01 "+a+" 2000"),"MM")),G(i.monthNumber,i.year),D()},i.setNewYear=function(a){if(i.day=void 0,i.dateMaxLimit&&i.year<Number(a)){if(!i.isSelectableMaxYear(a))return}else if(i.dateMinLimit&&i.year>Number(a)&&!i.isSelectableMinYear(a))return;i.year=Number(a),G(i.monthNumber,i.year),i.paginateYears(a)},i.hideCalendar=function(){l.classList?l.classList.remove("_720kb-datepicker-open"):E.remove(l,"_720kb-datepicker-open")},i.setDatepickerDay=function(a){0!=i.isPriceDay(i.year,i.monthNumber,a)&&i.isSelectableDate(i.monthNumber,i.year,a)&&i.isSelectableMaxDate(i.year+"/"+i.monthNumber+"/"+a)&&i.isSelectableMinDate(i.year+"/"+i.monthNumber+"/"+a)&&(i.day=Number(a),console.log(i.day),D())},i.priceOnDay=function(a){10>a&&(a="0"+a);var b=i.year+"-"+i.monthNumber+"-"+a;return i.comboWithPrice[b]?"￥"+i.comboWithPrice[b][1]:void 0},i.isPriceDay=function(a,b,c){10>c&&(c="0"+c);var d=a+"-"+b+"-"+c;return i.comboWithPrice[d]?!0:!1},i.paginateYears=function(a){var b,d=[],e=10,f=10;for(i.paginationYears=[],c&&(e=50,f=50,i.dateMinLimit&&i.dateMaxLimit&&(a=new Date(i.dateMaxLimit).getFullYear(),e=a-new Date(i.dateMinLimit).getFullYear(),f=1)),b=e;b>0;b-=1)d.push(Number(a)-b);for(b=0;f>b;b+=1)d.push(Number(a)+b);i.dateMaxLimit&&d&&d.length&&!i.isSelectableMaxYear(Number(d[d.length-1])+1)?i.paginationYearsNextDisabled=!0:i.paginationYearsNextDisabled=!1,i.dateMinLimit&&d&&d.length&&!i.isSelectableMinYear(Number(d[0])-1)?i.paginationYearsPrevDisabled=!0:i.paginationYearsPrevDisabled=!1,i.paginationYears=d},i.isDiscountDay=function(a,b,c){if(i.discount_days){for(var d=i.discount_days-1;d>=0;d--)if(date_arrays=discount_day.split(":"),discount_day[0]==b&&discount_day[1]==a&&discount_day[2]==c)return!0;return!1}},i.isSelectableDate=function(a,b,c){var d=0;if(s&&s.length>0)for(d;d<=s.length;d+=1)if(new Date(s[d]).getTime()===new Date(a+"/"+c+"/"+b).getTime())return!1;return!0},i.isSelectableMinDate=function(a){return i.dateMinLimit&&new Date(i.dateMinLimit)&&new Date(a).getTime()<new Date(i.dateMinLimit).getTime()?!1:!0},i.isSelectableMaxDate=function(a){return i.dateMaxLimit&&new Date(i.dateMaxLimit)&&new Date(a).getTime()>new Date(i.dateMaxLimit).getTime()?!1:!0},i.isSelectableMaxYear=function(a){return i.dateMaxLimit&&a>new Date(i.dateMaxLimit).getFullYear()?!1:!0},i.isSelectableMinYear=function(a){return i.dateMinLimit&&a<new Date(i.dateMinLimit).getFullYear()?!1:!0},y=y.replace(/{{/g,g.startSymbol()).replace(/}}/g,g.endSymbol()),i.dateMonthTitle=i.dateMonthTitle||"Select month",i.dateYearTitle=i.dateYearTitle||"Select year",i.buttonNextTitle=i.buttonNextTitle||"Next",i.buttonPrevTitle=i.buttonPrevTitle||"Prev",i.month=f("date")(t,"MMMM"),i.monthNumber=Number(f("date")(t,"MM")),i.day=Number(f("date")(t,"dd")),i.dateMaxLimit?i.year=Number(f("date")(new Date(i.dateMaxLimit),"yyyy")):i.year=Number(f("date")(t,"yyyy")),i.months=x.MONTH,i.daysInString=["日","一","二","三","四","五","六"],n.append(d(a.element(y))(i)),d(a.element(y))(i),l=j[0].querySelector("._720kb-datepicker-calendar"),w=!0,F(),a.element(l).on("mouseenter",function(){v=!0}),a.element(l).on("mouseleave",function(){v=!1}),a.element(l).on("focusin",function(){v=!0}),a.element(b).on("click focus",function(){v||w||!l||i.hideCalendar()}),i.dateMinLimit&&!i.isSelectableMinYear(i.year)&&z(),i.dateMaxLimit&&!i.isSelectableMaxYear(i.year)&&A(),i.paginateYears(i.year),G(i.monthNumber,i.year),i.$on("$destroy",function(){H(),a.element(l).off("mouseenter mouseleave focusin"),a.element(b).off("click focus")}),k.hasOwnProperty("visibleOnLoad")&&F()};return{restrict:"AEC",scope:{"picked-date":"=",isAdult:"@",comboWithPrice:"=",dateSet:"@",dateMinLimit:"@",dateMaxLimit:"@",dateMonthTitle:"@",dateYearTitle:"@",buttonNextTitle:"@",buttonPrevTitle:"@",dateDisabledDates:"@",dateSetHidden:"@"},transclude:!0,link:i}};a.module("720kb.datepicker",[]).directive("datepicker",["$window","$compile","$locale","$filter","$interpolate",i])}(angular,navigator),!function(a){"object"==typeof exports?module.exports=a():"function"==typeof define&&define.amd?define(a):"undefined"!=typeof window?window.QRCode=a():"undefined"!=typeof global?global.QRCode=a():"undefined"!=typeof self&&(self.QRCode=a())}(function(){return function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);throw new Error("Cannot find module '"+g+"'")}var j=c[g]={exports:{}};b[g][0].call(j.exports,function(a){var c=b[g][1][a];return e(c?c:a)},j,j.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b){function c(a){this.mode=d.MODE_ALPHA_NUM,this.data=a}var d=a("./QRMode.js");c.prototype.getCode=function(a){var b="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",c=b.indexOf(a);if(0>c)throw new Error("Invalid character: `"+a+"`");return c},c.prototype.getLength=function(){return this.data.length},c.prototype.write=function(a){for(var b=0;b<this.data.length;b++)this.data[b+1]?a.put(45*this.getCode(this.data[b])+this.getCode(this.data[b+1]),11):a.put(this.getCode(this.data[b]),6),b++},b.exports=c},{"./QRMode.js":9}],2:[function(a,b){function c(a){this.mode=d.MODE_NUMBER,this.data=a}var d=a("./QRMode.js");c.prototype.getCode=function(a){var b=parseInt(a,10);if(isNaN(b))throw new Error("Invalid character: `"+a+"`");return b},c.prototype.getBitLen=function(a){var b={3:10,2:7,1:4};return b[a]},c.prototype.getLength=function(){return this.data.length},c.prototype.write=function(a){for(var b=0;b<this.data.length;b++){var c=this.data[b];this.data[b+1]&&(c+=this.data[b+1]),this.data[b+2]&&(c+=this.data[b+2]);var d=this.getBitLen(c.length);a.put(this.getCode(c),d),b++,b++}},b.exports=c},{"./QRMode.js":9}],3:[function(a,b){function c(a){this.mode=d.MODE_8BIT_BYTE,this.data=a}var d=a("./QRMode.js");c.prototype.getCode=function(a){var b=a.charCodeAt(0);if(b>255)throw new Error("Invalid character: `"+a+"`");return b},c.prototype.getLength=function(){return this.data.length},c.prototype.write=function(a){for(var b=0;b<this.data.length;b++)a.put(this.getCode(this.data[b]),8)},b.exports=c},{"./QRMode.js":9}],4:[function(a,b){function c(){this.buffer=[],this.length=0}c.prototype.get=function(a){var b=Math.floor(a/8);return 1===(this.buffer[b]>>>7-a%8&1)},c.prototype.put=function(a,b){for(var c=0;b>c;c++)this.putBit(1===(a>>>b-c-1&1))},c.prototype.getLengthInBits=function(){return this.length},c.prototype.putBit=function(a){var b=Math.floor(this.length/8);this.buffer.length<=b&&this.buffer.push(0),a&&(this.buffer[b]|=128>>>this.length%8),this.length++},b.exports=c},{}],5:[function(a,b){function c(a,b,c){this.typeNumber=a,this.errorCorrectLevel=b,this.inputMode=c,this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[]}var d=a("./NUMBER.js"),e=a("./ALPHA_NUM.js"),f=a("./QR8bitByte.js"),g=a("./QRRSBlock.js"),h=a("./QRBitBuffer.js"),i=a("./QRUtil.js"),j=a("./QRPolynomial.js");c.prototype.addData=function(a){var b;b="NUMBER"===this.inputMode?new d(a):"ALPHA_NUM"===this.inputMode?new e(a):new f(a),this.dataList.push(b),this.dataCache=null},c.prototype.isDark=function(a,b){if(0>a||this.moduleCount<=a||0>b||this.moduleCount<=b)throw new Error(a+","+b);return this.modules[a][b]},c.prototype.getModuleCount=function(){return this.moduleCount},c.prototype.make=function(){var a;if(this.typeNumber<1){var b=1;for(b=1;40>b;b++){var c=g.getRSBlocks(b,this.errorCorrectLevel),d=new h,e=0;for(a=0;a<c.length;a++)e+=c[a].dataCount;for(a=0;a<this.dataList.length;a++){var f=this.dataList[a];d.put(f.mode,4),d.put(f.getLength(),i.getLengthInBits(f.mode,b)),f.write(d)}if(d.getLengthInBits()<=8*e)break}this.typeNumber=b}this.makeImpl(!1,this.getBestMaskPattern())},c.prototype.makeImpl=function(a,b){this.moduleCount=4*this.typeNumber+17,this.modules=new Array(this.moduleCount);for(var d=0;d<this.moduleCount;d++){this.modules[d]=new Array(this.moduleCount);for(var e=0;e<this.moduleCount;e++)this.modules[d][e]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(a,b),this.typeNumber>=7&&this.setupTypeNumber(a),null===this.dataCache&&(this.dataCache=c.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,b)},c.prototype.setupPositionProbePattern=function(a,b){for(var c=-1;7>=c;c++)if(!(-1>=a+c||this.moduleCount<=a+c))for(var d=-1;7>=d;d++)-1>=b+d||this.moduleCount<=b+d||(this.modules[a+c][b+d]=c>=0&&6>=c&&(0===d||6===d)||d>=0&&6>=d&&(0===c||6===c)||c>=2&&4>=c&&d>=2&&4>=d?!0:!1)},c.prototype.getBestMaskPattern=function(){for(var a=0,b=0,c=0;8>c;c++){this.makeImpl(!0,c);var d=i.getLostPoint(this);(0===c||a>d)&&(a=d,b=c)}return b},c.prototype.createMovieClip=function(a,b,c){var d=a.createEmptyMovieClip(b,c),e=1;this.make();for(var f=0;f<this.modules.length;f++)for(var g=f*e,h=0;h<this.modules[f].length;h++){var i=h*e,j=this.modules[f][h];j&&(d.beginFill(0,100),d.moveTo(i,g),d.lineTo(i+e,g),d.lineTo(i+e,g+e),d.lineTo(i,g+e),d.endFill())}return d},c.prototype.setupTimingPattern=function(){for(var a=8;a<this.moduleCount-8;a++)null===this.modules[a][6]&&(this.modules[a][6]=a%2===0);for(var b=8;b<this.moduleCount-8;b++)null===this.modules[6][b]&&(this.modules[6][b]=b%2===0)},c.prototype.setupPositionAdjustPattern=function(){for(var a=i.getPatternPosition(this.typeNumber),b=0;b<a.length;b++)for(var c=0;c<a.length;c++){var d=a[b],e=a[c];if(null===this.modules[d][e])for(var f=-2;2>=f;f++)for(var g=-2;2>=g;g++)this.modules[d+f][e+g]=-2===f||2===f||-2===g||2===g||0===f&&0===g?!0:!1}},c.prototype.setupTypeNumber=function(a){var b,c,d=i.getBCHTypeNumber(this.typeNumber);for(c=0;18>c;c++)b=!a&&1===(d>>c&1),this.modules[Math.floor(c/3)][c%3+this.moduleCount-8-3]=b;for(c=0;18>c;c++)b=!a&&1===(d>>c&1),this.modules[c%3+this.moduleCount-8-3][Math.floor(c/3)]=b},c.prototype.setupTypeInfo=function(a,b){var c,d,e=this.errorCorrectLevel<<3|b,f=i.getBCHTypeInfo(e);for(d=0;15>d;d++)c=!a&&1===(f>>d&1),6>d?this.modules[d][8]=c:8>d?this.modules[d+1][8]=c:this.modules[this.moduleCount-15+d][8]=c;for(d=0;15>d;d++)c=!a&&1===(f>>d&1),8>d?this.modules[8][this.moduleCount-d-1]=c:9>d?this.modules[8][15-d-1+1]=c:this.modules[8][15-d-1]=c;this.modules[this.moduleCount-8][8]=!a},c.prototype.mapData=function(a,b){for(var c=-1,d=this.moduleCount-1,e=7,f=0,g=this.moduleCount-1;g>0;g-=2)for(6===g&&g--;;){for(var h=0;2>h;h++)if(null===this.modules[d][g-h]){var j=!1;f<a.length&&(j=1===(a[f]>>>e&1));var k=i.getMask(b,d,g-h);k&&(j=!j),this.modules[d][g-h]=j,e--,-1===e&&(f++,e=7)}if(d+=c,0>d||this.moduleCount<=d){d-=c,c=-c;break}}},c.PAD0=236,c.PAD1=17,c.createData=function(a,b,d){var e,f=g.getRSBlocks(a,b),j=new h;for(e=0;e<d.length;e++){var k=d[e];j.put(k.mode,4),j.put(k.getLength(),i.getLengthInBits(k.mode,a)),k.write(j)}var l=0;for(e=0;e<f.length;e++)l+=f[e].dataCount;if(j.getLengthInBits()>8*l)throw new Error("code length overflow. ("+j.getLengthInBits()+">"+8*l+")");for(j.getLengthInBits()+4<=8*l&&j.put(0,4);j.getLengthInBits()%8!==0;)j.putBit(!1);for(;!(j.getLengthInBits()>=8*l)&&(j.put(c.PAD0,8),!(j.getLengthInBits()>=8*l));)j.put(c.PAD1,8);return c.createBytes(j,f)},c.createBytes=function(a,b){var c,d,e=0,f=0,g=0,h=new Array(b.length),k=new Array(b.length);for(d=0;d<b.length;d++){var l=b[d].dataCount,m=b[d].totalCount-l;for(f=Math.max(f,l),g=Math.max(g,m),h[d]=new Array(l),c=0;c<h[d].length;c++)h[d][c]=255&a.buffer[c+e];e+=l;var n=i.getErrorCorrectPolynomial(m),o=new j(h[d],n.getLength()-1),p=o.mod(n);for(k[d]=new Array(n.getLength()-1),c=0;c<k[d].length;c++){var q=c+p.getLength()-k[d].length;k[d][c]=q>=0?p.get(q):0}}var r=0;for(c=0;c<b.length;c++)r+=b[c].totalCount;var s=new Array(r),t=0;for(c=0;f>c;c++)for(d=0;d<b.length;d++)c<h[d].length&&(s[t++]=h[d][c]);for(c=0;g>c;c++)for(d=0;d<b.length;d++)c<k[d].length&&(s[t++]=k[d][c]);return s},b.exports=c},{"./ALPHA_NUM.js":1,"./NUMBER.js":2,"./QR8bitByte.js":3,"./QRBitBuffer.js":4,"./QRPolynomial.js":10,"./QRRSBlock.js":11,"./QRUtil.js":12}],6:[function(a,b){var c={L:1,M:0,Q:3,H:2};b.exports=c},{}],7:[function(a,b){var c={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};b.exports=c},{}],8:[function(a,b){for(var c={glog:function(a){if(1>a)throw new Error("glog("+a+")");return c.LOG_TABLE[a]},gexp:function(a){for(;0>a;)a+=255;for(;a>=256;)a-=255;return c.EXP_TABLE[a]},EXP_TABLE:new Array(256),LOG_TABLE:new Array(256)},d=0;8>d;d++)c.EXP_TABLE[d]=1<<d;for(var d=8;256>d;d++)c.EXP_TABLE[d]=c.EXP_TABLE[d-4]^c.EXP_TABLE[d-5]^c.EXP_TABLE[d-6]^c.EXP_TABLE[d-8];for(var d=0;255>d;d++)c.LOG_TABLE[c.EXP_TABLE[d]]=d;b.exports=c},{}],9:[function(a,b){var c={MODE_NUMBER:1,MODE_ALPHA_NUM:2,MODE_8BIT_BYTE:4,MODE_KANJI:8};b.exports=c},{}],10:[function(a,b){function c(a,b){if(void 0===a.length)throw new Error(a.length+"/"+b);for(var c=0;c<a.length&&0===a[c];)c++;this.num=new Array(a.length-c+b);for(var d=0;d<a.length-c;d++)this.num[d]=a[d+c]}var d=a("./QRMath.js");c.prototype.get=function(a){return this.num[a]},c.prototype.getLength=function(){return this.num.length},c.prototype.multiply=function(a){for(var b=new Array(this.getLength()+a.getLength()-1),e=0;e<this.getLength();e++)for(var f=0;f<a.getLength();f++)b[e+f]^=d.gexp(d.glog(this.get(e))+d.glog(a.get(f)));return new c(b,0)},c.prototype.mod=function(a){if(this.getLength()-a.getLength()<0)return this;var b,e=d.glog(this.get(0))-d.glog(a.get(0)),f=new Array(this.getLength());for(b=0;b<this.getLength();b++)f[b]=this.get(b);for(b=0;b<a.getLength();b++)f[b]^=d.gexp(d.glog(a.get(b))+e);return new c(f,0).mod(a)},b.exports=c},{"./QRMath.js":8}],11:[function(a,b){function c(a,b){this.totalCount=a,this.dataCount=b}var d=a("./QRErrorCorrectLevel.js");c.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],c.getRSBlocks=function(a,b){var d=c.getRsBlockTable(a,b);if(void 0===d)throw new Error("bad rs block @ typeNumber:"+a+"/errorCorrectLevel:"+b);for(var e=d.length/3,f=[],g=0;e>g;g++)for(var h=d[3*g+0],i=d[3*g+1],j=d[3*g+2],k=0;h>k;k++)f.push(new c(i,j));return f},c.getRsBlockTable=function(a,b){switch(b){case d.L:return c.RS_BLOCK_TABLE[4*(a-1)+0];case d.M:return c.RS_BLOCK_TABLE[4*(a-1)+1];case d.Q:return c.RS_BLOCK_TABLE[4*(a-1)+2];case d.H:return c.RS_BLOCK_TABLE[4*(a-1)+3];default:return void 0}},b.exports=c},{"./QRErrorCorrectLevel.js":6}],12:[function(a,b){var c=a("./QRMaskPattern.js"),d=a("./QRPolynomial.js"),e=a("./QRMath.js"),f=a("./QRMode.js"),g={};g.PATTERN_POSITION_TABLE=[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],g.G15=1335,g.G18=7973,g.G15_MASK=21522,g.getBCHTypeInfo=function(a){for(var b=a<<10;g.getBCHDigit(b)-g.getBCHDigit(g.G15)>=0;)b^=g.G15<<g.getBCHDigit(b)-g.getBCHDigit(g.G15);return(a<<10|b)^g.G15_MASK},g.getBCHTypeNumber=function(a){for(var b=a<<12;g.getBCHDigit(b)-g.getBCHDigit(g.G18)>=0;)b^=g.G18<<g.getBCHDigit(b)-g.getBCHDigit(g.G18);return a<<12|b},g.getBCHDigit=function(a){for(var b=0;0!==a;)b++,a>>>=1;return b},g.getPatternPosition=function(a){return g.PATTERN_POSITION_TABLE[a-1]},g.getMask=function(a,b,d){switch(a){case c.PATTERN000:return(b+d)%2===0;case c.PATTERN001:return b%2===0;case c.PATTERN010:return d%3===0;case c.PATTERN011:return(b+d)%3===0;case c.PATTERN100:return(Math.floor(b/2)+Math.floor(d/3))%2===0;case c.PATTERN101:return b*d%2+b*d%3===0;case c.PATTERN110:return(b*d%2+b*d%3)%2===0;case c.PATTERN111:return(b*d%3+(b+d)%2)%2===0;default:throw new Error("bad maskPattern:"+a)}},g.getErrorCorrectPolynomial=function(a){for(var b=new d([1],0),c=0;a>c;c++)b=b.multiply(new d([1,e.gexp(c)],0));return b},g.getLengthInBits=function(a,b){if(b>=1&&10>b)switch(a){case f.MODE_NUMBER:return 10;case f.MODE_ALPHA_NUM:return 9;case f.MODE_8BIT_BYTE:return 8;case f.MODE_KANJI:return 8;default:throw new Error("mode:"+a)}else if(27>b)switch(a){case f.MODE_NUMBER:return 12;case f.MODE_ALPHA_NUM:return 11;case f.MODE_8BIT_BYTE:return 16;case f.MODE_KANJI:return 10;default:throw new Error("mode:"+a)}else{if(!(41>b))throw new Error("type:"+b);switch(a){case f.MODE_NUMBER:return 14;case f.MODE_ALPHA_NUM:return 13;case f.MODE_8BIT_BYTE:return 16;case f.MODE_KANJI:return 12;default:throw new Error("mode:"+a)}}},g.getLostPoint=function(a){var b,c,d=a.getModuleCount(),e=0;for(b=0;d>b;b++)for(c=0;d>c;c++){for(var f=0,g=a.isDark(b,c),h=-1;1>=h;h++)if(!(0>b+h||b+h>=d))for(var i=-1;1>=i;i++)0>c+i||c+i>=d||(0!==h||0!==i)&&g===a.isDark(b+h,c+i)&&f++;f>5&&(e+=3+f-5)}for(b=0;d-1>b;b++)for(c=0;d-1>c;c++){var j=0;a.isDark(b,c)&&j++,a.isDark(b+1,c)&&j++,a.isDark(b,c+1)&&j++,a.isDark(b+1,c+1)&&j++,(0===j||4===j)&&(e+=3)}for(b=0;d>b;b++)for(c=0;d-6>c;c++)a.isDark(b,c)&&!a.isDark(b,c+1)&&a.isDark(b,c+2)&&a.isDark(b,c+3)&&a.isDark(b,c+4)&&!a.isDark(b,c+5)&&a.isDark(b,c+6)&&(e+=40);for(c=0;d>c;c++)for(b=0;d-6>b;b++)a.isDark(b,c)&&!a.isDark(b+1,c)&&a.isDark(b+2,c)&&a.isDark(b+3,c)&&a.isDark(b+4,c)&&!a.isDark(b+5,c)&&a.isDark(b+6,c)&&(e+=40);var k=0;for(c=0;d>c;c++)for(b=0;d>b;b++)a.isDark(b,c)&&k++;var l=Math.abs(100*k/d/d-50)/5;return e+=10*l},b.exports=g},{"./QRMaskPattern.js":7,"./QRMath.js":8,"./QRMode.js":9,"./QRPolynomial.js":10}]},{},[5])(5)}),function(a){"use strict";angular.module("ja.qr",[]).controller("QrCtrl",["$scope",function(a){a.getTypeNumeber=function(){return a.typeNumber||0},a.getCorrection=function(){var b={L:1,M:0,Q:3,H:2},c=a.correctionLevel||0;return b[c]||0},a.getText=function(){return a.text||""},a.getSize=function(){return a.size||250},a.isNUMBER=function(a){var b=/^[0-9]*$/;return b.test(a)},a.isALPHA_NUM=function(a){var b=/^[0-9A-Z $%*+\-.\/:]*$/;return b.test(a)},a.is8bit=function(a){for(var b=0;b<a.length;b++){var c=a.charCodeAt(b);if(c>255)return!1}return!0},a.checkInputMode=function(b,c){if("NUMBER"===b&&!a.isNUMBER(c))throw new Error("The `NUMBER` input mode is invalid for text.");if("ALPHA_NUM"===b&&!a.isALPHA_NUM(c))throw new Error("The `ALPHA_NUM` input mode is invalid for text.");if("8bit"===b&&!a.is8bit(c))throw new Error("The `8bit` input mode is invalid for text.");if(!a.is8bit(c))throw new Error("Input mode is invalid for text.");return!0},a.getInputMode=function(b){var c=a.inputMode;return c=c||(a.isNUMBER(b)?"NUMBER":void 0),c=c||(a.isALPHA_NUM(b)?"ALPHA_NUM":void 0),c=c||(a.is8bit(b)?"8bit":""),a.checkInputMode(c,b)?c:""}}]).directive("qr",["$timeout","$window",function(b,c){return{restrict:"E",template:'<canvas ng-hide="image"></canvas><image ng-if="image" ng-src="{{canvasImage}}"/>',scope:{typeNumber:"=",correctionLevel:"=",inputMode:"=",size:"=",text:"=",image:"="},controller:"QrCtrl",link:function(d,e,f){if(void 0===d.text)throw new Error("The `text` attribute is required.");var g=e.find("canvas")[0],h=!!c.CanvasRenderingContext2D;d.TYPE_NUMBER=d.getTypeNumeber(),d.TEXT=d.getText(),d.CORRECTION=d.getCorrection(),d.SIZE=d.getSize(),d.INPUT_MODE=d.getInputMode(d.TEXT),d.canvasImage="http://lorempixel.com/500/500/";var i=function(a,b,c,d){for(var e=0;c>e;e++)for(var f=0;c>f;f++){var g=Math.ceil((f+1)*d)-Math.floor(f*d),h=Math.ceil((e+1)*d)-Math.floor(e*d);a.fillStyle=b.isDark(e,f)?"#000":"#fff",a.fillRect(Math.round(f*d),Math.round(e*d),g,h)}},j=function(b,c,e,f,g,j){var k=/^\s+|\s+$/g,l=c.replace(k,""),m=new a(e,f,j);m.addData(l),m.make();var n=b.getContext("2d"),o=m.getModuleCount(),p=g/o;b.width=b.height=g,h&&(i(n,m,o,p),d.canvasImage=b.toDataURL())};j(g,d.TEXT,d.TYPE_NUMBER,d.CORRECTION,d.SIZE,d.INPUT_MODE),b(function(){d.$watch("text",function(a,b){a!==b&&(d.TEXT=d.getText(),d.INPUT_MODE=d.getInputMode(d.TEXT),j(g,d.TEXT,d.TYPE_NUMBER,d.CORRECTION,d.SIZE,d.INPUT_MODE))}),d.$watch("correctionLevel",function(a,b){a!==b&&(d.CORRECTION=d.getCorrection(),j(g,d.TEXT,d.TYPE_NUMBER,d.CORRECTION,d.SIZE,d.INPUT_MODE))}),d.$watch("typeNumber",function(a,b){a!==b&&(d.TYPE_NUMBER=d.getTypeNumeber(),j(g,d.TEXT,d.TYPE_NUMBER,d.CORRECTION,d.SIZE,d.INPUT_MODE))}),d.$watch("size",function(a,b){a!==b&&(d.SIZE=d.getSize(),j(g,d.TEXT,d.TYPE_NUMBER,d.CORRECTION,d.SIZE,d.INPUT_MODE))}),d.$watch("inputMode",function(a,b){a!==b&&(d.INPUT_MODE=d.getInputMode(d.TEXT),j(g,d.TEXT,d.TYPE_NUMBER,d.CORRECTION,d.SIZE,d.INPUT_MODE))})})}}}])}(window.QRCode),angular.module("WeiJianApp",["config","ngCookies","ngRoute","ngTouch","ui.router","angular-md5","ab-base64","ionic","angular-carousel","WeiJianAppFilter","720kb.datepicker","hSweetAlert","ja.qr"]).run(["$rootScope","$cookies","$location","User","ENV","WX",function(a,b,c,d,e,f){document.getElementById("spinner").style.display="none",a.ua=navigator.userAgent.toLowerCase(),a.font_size=1*window.screen.width/320*64,a.swidth=window.screen.width;var g=navigator.userAgent.toLowerCase();if(g.indexOf("android")>-1){var h=parseInt(g.split("applewebkit/")[1].substring(0,3));537>h&&(a.font_size=a.font_size/window.devicePixelRatio),a.is_android=!0}(a.ua.indexOf("iphone")>-1||a.ua.indexOf("ipad")>-1)&&(a.is_ios=!0),a.html_font_size="font-size:"+a.font_size+"px",a.swidth_rem=window.screen.width/a.font_size,a.compressImageUrl=function(b,c,d,e,f){if(console.log(b),!b)return null;if(e===!0)return"http://www.techmars.net/"+b;d=d||window.screen.width/a.font_size;var g=d*c*a.font_size*a.font_size;return g*=window.devicePixelRatio*window.devicePixelRatio,f?b+"?imageMogr2/thumbnail/"+g+"@":b+"?imageMogr2/thumbnail/"+g+"@/format/jpg"},a.setWeiXinTitle=function(b){if(a.is_ios){document.getElementsByTagName("body")[0];document.title=b;var c=document.createElement("iframe");c.setAttribute("src","http://7xls5t.com2.z0.glb.qiniucdn.com/loading.png"),c.addEventListener("load",function(){
setTimeout(function(){c.removeEventListener("load"),document.body.removeChild(c)},0)}),document.body.appendChild(c)}else document.title=b},a.execute=function(a,d){return e.isDebug?(b.put("token",e.fake_token),void a()):void(b.get("token")?a():(d=d||window.location.href,d.indexOf("token=")>-1&&(d=d.replace("token="+c.search().token,"")),d=d.split("/#/app/")[1].replace(/\//g,"OO"),location.href="https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx7ddd028c2621995d&redirect_uri=http://www.techmars.net/api/v1/wxauth&response_type=code&scope=snsapi_base&state="+d))},f.getWX({url:window.location.href.split("#")[0]}).then(function(a){var b=a.data;b.jsApiList=["onMenuShareTimeline","onMenuShareAppMessage","onMenuShareQQ","onMenuShareWeibo","onMenuShareQZone"],wx.config(b)}),a.share=function(a,b,d,e,f,g){d&&-1==d.indexOf("http")&&(d="http://www.techmars.net/"+d),e=e||window.location.href,e.indexOf("?token=")>-1&&(e=e.replace("?token="+c.search().token,""));var h={title:a,desc:b||"",imgUrl:d||"http://7xls5t.com2.z0.glb.qiniucdn.com/250.png",link:e,type:"link",success:"function"==typeof f?f():function(){},cancel:"function"==typeof g?g():function(){}};wx.onMenuShareTimeline(h),wx.onMenuShareAppMessage(h),wx.onMenuShareQQ(h),wx.onMenuShareWeibo(h),wx.onMenuShareQZone(h)}}]).controller("RouteCtrl",["$q","$scope","$state","$location","AppAuth","$cookies",function(a,b,c,d,e,f){d.path("/app")}]).controller("LayoutCtrl",["$scope","ENV","md5",function(a,b,c){}]).config(["$stateProvider","$urlRouterProvider",function(a,b){a.state("login",{url:"/login",template:"<login></login>",controller:"LoginCtrl"}).state("register",{url:"/register",template:"<register></register>",controller:"LoginCtrl"}).state("router",{url:"/router",template:'<div class="lockscreen" style="height: 100%"></div>',controller:"RouteCtrl"}),b.otherwise("/router")}]).config(["$routeProvider","$httpProvider",function(a,b){b.interceptors.push(["$q","$location","AppAuth",function(a,b,c){return{responseError:function(b){return a.reject(b)}}}])}]),angular.module("config",[]).constant("ENV",{name:"development",apiUrl:"http://www.techmars.net/api",fake_token:" ",isDebug:!0}),angular.module("WeiJianApp").config(["$stateProvider",function(a){a.state("app",{"abstract":!0,url:"/app",templateUrl:"views/home/main.html",controller:"MainCtrl"}).state("app.home",{url:"",templateUrl:"views/home/list.html",controller:"HomeCtrl"})}]).controller("MainCtrl",["$scope","$cookies",function(a,b){}]).controller("HomeCtrl",["$scope","Banner","$location","$cookies","HomeCard","$state",function(a,b,c,d,e,f){a.setWeiXinTitle("未见旅游"),a.share("未见旅游","未见，未曾遇见过的美好"),b.getBanners().then(function(b){a.banners=b.data;var c=a.banners.length;a.banner_style=(a.swidth_rem-(.08*c+.067*c))/2+"rem",a.bannerClicked=function(a){location.href=a.banner_link_to}}),e.getHomeCards().then(function(b){a.home_cards=b.data}),a.home_cardClicked=function(a){f.go("app.categories.list",{category_name:a.card_text,link:a.card_link_to})}}]),angular.module("WeiJianApp").config(["$stateProvider",function(a){a.state("app.categories",{"abstract":!0,url:"/categories",templateUrl:"views/category/main.html",controller:"CategoryCtrl"}).state("app.categories.list",{url:"/list/:category_name/link/:link",templateUrl:"views/category/list.html",controller:"CategoryListCtrl"})}]).controller("CategoryCtrl",["$scope","Product","$state","$stateParams",function(a,b,c,d){}]).controller("CategoryListCtrl",["$scope","$stateParams","Product","$ionicScrollDelegate",function(a,b,c,d){function e(){a.items=a.product.items.filter(g("产品类型","p_type",0)).filter(g("出发地","src",1)).filter(g("目的地","dst",2)).filter(f("出发时间","off_time",3)),d.resize(),console.log(a.items)}function f(b,c,d){return function(e){return console.log(b,c,a.select_data[d].title),a.select_data[d].title&&"全部"!=a.select_data[d].title&&a.select_data[d].title!=b?e[c].indexOf(a.select_data[d].title)>-1:!0}}function g(b,c,d){return function(e){return console.log(b,c,a.select_data[d].title),a.select_data[d].title&&"全部"!=a.select_data[d].title&&a.select_data[d].title!=b?e[c]==a.select_data[d].title:!0}}a.current_index=0,a.setWeiXinTitle(b.category_name),a.share("未见旅游-"+b.category_name,"未见，未曾遇见过的美好"),a.select_data=[],a.items=[],a.select_types=c.select_types,c.getItems(b.link).then(function(c){a.product=c.data,console.info(c.data),a.select_data[0]=a.product.p_types,a.select_data[1]=a.product.sources,a.select_data[2]=a.product.destinations,a.select_data[3]=a.product.departure_time,a.select_data[0].name="产品类型",a.select_data[1].name="出发地",a.select_data[2].name="目的地",a.select_data[3].name="出行时间";for(var d=a.select_data.length-1;d>=0;d--)a.select_data[d].sets.unshift(["全部",a.select_data[d].total]);console.log("图:"+a.product.items[0].img_url),a.share("未见旅游-"+b.category_name,a.product.items[0].img_url),a.items=angular.copy(a.product.items),console.log(a.items),console.log(a.select_data)}),a.selectClick=function(b){return a.current_index==b&&a.is_select_menu?void(a.is_select_menu=!1):(a.is_select_menu=!0,void(a.current_index=b))},a.listItemClicked=function(b){a.is_select_menu=!1,a.select_data[a.current_index].title=a.select_data[a.current_index].sets[b][0],e()},a.isSelectTitle=function(b){return b==a.current_index&&a.is_select_menu},a.getTitle=function(b){return a.select_data[b].title&&"全部"!=a.select_data[b].title?a.select_data[b].title:a.select_data[b].name}}]),angular.module("WeiJianApp").config(["$stateProvider",function(a){a.state("app.items",{"abstract":!0,url:"/items",templateUrl:"views/item/main.html",controller:"ItemCtrl"}).state("app.items.list",{url:"/list/:item_id",templateUrl:"views/item/list.html",controller:"ItemListCtrl"})}]).controller("ItemCtrl",["$scope","Item","$stateParams",function(a,b,c){}]).controller("ItemListCtrl",["$scope","Item","$stateParams","$location","$ionicScrollDelegate",function(a,b,c,d,e){a.share("未见旅游","未见，未曾遇见过的美好"),a.getNumber=function(a){for(var b=new Array(parseInt(a)),c=0;c<parseInt(a);c++)b[c]=c;return b},b.getItemById(c.item_id).then(function(b){a.item=b.data,a.item.id=c.item_id,a.setWeiXinTitle(a.item.title),console.log(a.item),a.share("未见旅游-"+a.item.title,"未见，未曾遇见过的美好",a.item.feature_img[0])}),a.gotoAnchor=function(a,b){return b?void e.resize().then(function(){e.$getByHandle("mainScroll").anchorScroll("#"+d.hash(a))}):void e.resize()}}]),angular.module("WeiJianApp").config(["$stateProvider",function(a){a.state("app.carts",{"abstract":!0,url:"/carts",templateUrl:"views/cart/main.html",controller:"CartCtrl"}).state("app.carts.list",{url:"/list/:item_id",templateUrl:"views/cart/list.html",controller:"CartListCtrl"})}]).controller("CartCtrl",["$scope",function(a){}]).controller("CartListCtrl",["$scope","$location","$stateParams","$cookies","$state","Item","sweet","User",function(a,b,c,d,e,f,g,h){a.share("未见旅游","未见，未曾遇见过的美好"),a.pickedDate="2015-10-10",a.pickedPrice="1000",a.bounds=null,a.shipping_address={},a.is_adult=1,a.adult_number=0,a.children_number=0,a.item_mumber=1,a.cart=[],a.total_price=0,a.date_check=!1,a.user={},a.execute(function(){h.getUser().then(function(b){a.user=b.data,console.log(b.data),a.shipping_address={name:a.user.name,phone:a.user.phone,email:a.user.email}})},"//#/app/carts/list/"+c.item_id),d.get("o")&&(a.shipping_address||(a.shipping_address=angular.fromJson(d.get("o")).shipping_address)),f.getItemById(c.item_id).then(function(b){a.item=b.data,a.item.id=c.item_id,console.log(a.item),a.selected_combo_id=a.item.combo[0][0],a.selected_combo_name=a.item.combo[0][1],a.comboWithPrice=a.item.price[""+a.selected_combo_id],console.log(a.comboWithPrice),a.share("未见旅游-"+a.item.title,"未见，未曾遇见过的美好");var d=Object.keys(a.comboWithPrice);a.selected_prices=a.item.price[""+a.selected_combo_id][d[0]],console.log(a.selected_prices),a.dateSet=d[0].split("-").join("/"),a.pickedDate=d[0].split("-").join("/"),a.selected_prices[3]>0&&(a.adult_number=1)}),a.cloudTagClicked=function(b){a.selected_combo_id=b[0],a.selected_combo_name=b[1],console.log(a.selected_combo_id,a.selected_combo_name),a.comboWithPrice=a.item.price[""+a.selected_combo_id],console.log(a.comboWithPrice);var c=Object.keys(a.comboWithPrice);a.selected_prices=a.item.price[""+a.selected_combo_id][c[0]],a.dateSet=c[0].split("-").join("/"),a.pickedDate=c[0].split("-").join("/"),console.log(a.selected_prices)},a.changeCouponCheck=function(){a.coupon_check=!a.coupon_check},a.coupondiscount=function(){var b=100*(a.adult_number+a.children_number);return a.user.my_coupon<=b?a.user.my_coupon:b},a.changeDateCheck=function(){a.date_check=!a.date_check},a.changePrice=function(b){a.dateSet=b,a.pickedDate=b,a.selected_prices=a.item.price[""+a.selected_combo_id][b],a.date_check=!1},a.addNum=function(b){if(0==b){if(a.adult_number>=a.selected_prices[3])return;a.adult_number++}else{if(0==a.adult_number)return;if(a.children_number>=a.selected_prices[4])return;a.children_number++}a.item_mumber++,console.log(a.selected_prices)},a.decNum=function(b){if(0==b){if(a.adult_number<=0)return;a.adult_number--}else{if(a.children_number<=0)return;a.children_number--}},a.placeOrder=function(){var b=a.adult_number*a.selected_prices[1]+a.children_number*a.selected_prices[2],f={combo_name:a.selected_combo_name,combo_id:a.selected_combo_id,adult_number:a.adult_number,children_number:a.children_number,adult_price:a.selected_prices[1],children_price:a.selected_prices[2],date:a.pickedDate.split("/").join("-"),total_price:b,real_price:a.coupon_check?b-a.coupondiscount():b,created:Date.parse(new Date)/1e3,title:a.item.title,coupon_check:a.coupon_check?1:0,coupon:a.coupondiscount()};d.put("o",JSON.stringify(f));var g={product:c.item_id,combo:a.selected_combo_id,price:a.comboWithPrice[a.pickedDate.split("/").join("-")][0],people:[f.adult_number,f.children_number],total_cost:f.real_price,coupon:a.coupon_check?1:0};d.put("o_params",JSON.stringify(g)),e.go("app.information.list")}}]),angular.module("WeiJianApp").config(["$stateProvider",function(a){a.state("app.pay",{"abstract":!0,url:"/pay",templateUrl:"views/pay/main.html",controller:"PayCtrl"}).state("app.pay.list",{url:"/list/:order_id",templateUrl:"views/pay/list.html",controller:"PayListCtrl"}).state("app.pay.wxpay",{url:"/wxpay/:order_id",templateUrl:"views/pay/wxpay.html",controller:"WXPayCtrl"}).state("app.pay.xxpay",{url:"/xxpay/:order_id",templateUrl:"views/pay/xxpay.html",controller:"XXPayCtrl"})}]).controller("PayCtrl",["$scope","$stateParams",function(a,b){}]).controller("PayListCtrl",["$scope","$stateParams","$cookies","$state",function(a,b,c,d){a.share("未见旅游","未见，未曾遇见过的美好"),a.setWeiXinTitle("去支付"),a.order=angular.fromJson(c.get("o")),a.pay_ways={is_wx_pay:!0,is_xx_pay:!1},console.log(a.order),a.order_id=b.order_id,a.goToPay=function(){a.pay_ways.is_xx_pay&&d.go("app.pay.xxpay",{order_id:b.order_id}),a.pay_ways.is_wx_pay&&d.go("app.pay.wxpay",{order_id:b.order_id})}}]).controller("WXPayCtrl",["$scope","$stateParams","$cookies","ENV","Pay",function(a,b,c,d,e){a.share("未见旅游","未见，未曾遇见过的美好","","http://www.techmars.net/weijian/#/app"),a.order_id=b.order_id;var f=angular.fromJson(c.get("o"));c.put("o_params");a.real_price=f.real_price,a.qcode_image_url=d.apiUrl+"/v1/wxqr?trade_no="+a.order_id,e.getWXQRcode(a.order_id).then(function(b){a.qrcode_url=b.data.url,console.log(a.qrcode_url)})}]).controller("XXPayCtrl",["$scope","$stateParams","$cookies","ENV",function(a,b,c,d){a.share("未见旅游","未见，未曾遇见过的美好","","http://www.techmars.net/weijian/#/app"),a.order_id=b.order_id;angular.fromJson(c.get("o"))}]),angular.module("WeiJianApp").config(["$stateProvider",function(a){a.state("app.order",{"abstract":!0,url:"/order",templateUrl:"views/order/main.html",controller:"OrderCtrl"}).state("app.order.list",{url:"/list",templateUrl:"views/order/list.html",controller:"OrderListCtrl"})}]).controller("OrderCtrl",["$scope","$stateParams",function(a,b){}]).controller("OrderListCtrl",["$scope","$stateParams","Order",function(a,b,c){a.setWeiXinTitle("我的订单");var d={};a.selecTabIndex=0,a.execute(function(){c.getOrders().then(function(b){d=b.data,a.display_orders=d.complete.concat(d.incomplete),console.log(a.display_orders)})},"//#/app/order/list"),a.changeTab=function(b){if(b!=a.selecTabIndex)switch(a.selecTabIndex=b,b){case 0:a.display_orders=d.complete.concat(d.incomplete);break;case 1:a.display_orders=d.incomplete;break;case 2:a.display_orders=d.complete}}}]),angular.module("WeiJianApp").config(["$stateProvider",function(a){a.state("app.bounds",{"abstract":!0,url:"/bounds",templateUrl:"views/bounds/main.html",controller:"BoundsCtrl"}).state("app.bounds.list",{url:"/list",templateUrl:"views/bounds/list.html",controller:"BoundsListCtrl"})}]).controller("BoundsCtrl",["$scope","$stateParams",function(a,b){}]).controller("BoundsListCtrl",["$scope","$stateParams","Bound",function(a,b,c){a.setWeiXinTitle("我的代金券"),a.bounds={},a.selecTabIndex=0,a.execute(function(){c.getBounds().then(function(b){a.bounds=b.data,a.display_bounds=a.bounds.income.concat(a.bounds.outcome),console.log(a.display_bounds)})},"//#/app/bounds/list"),a.changeTab=function(b){if(b!=a.selecTabIndex)switch(a.selecTabIndex=b,b){case 0:a.display_bounds=a.bounds.income.concat(a.bounds.outcome);break;case 1:a.display_bounds=a.bounds.income;break;case 2:a.display_bounds=a.bounds.outcome}}}]),angular.module("WeiJianApp").config(["$stateProvider",function(a){a.state("app.wait",{"abstract":!0,url:"/wait",templateUrl:"views/wait/main.html",controller:"WaitCtrl"}).state("app.wait.list",{url:"/list/:title",templateUrl:"views/wait/list.html",controller:"WaitListCtrl"})}]).controller("WaitCtrl",["$scope","$stateParams",function(a,b){}]).controller("WaitListCtrl",["$scope","$stateParams",function(a,b){a.setWeiXinTitle(b.title||"敬请期待")}]),angular.module("WeiJianApp").config(["$stateProvider",function(a){a.state("app.invite",{"abstract":!0,url:"/invite",templateUrl:"views/invite/main.html",controller:"InviteCtrl"}).state("app.invite.list",{url:"/list",templateUrl:"views/invite/list.html",controller:"InviteListCtrl"})}]).controller("InviteCtrl",function(){}).controller("InviteListCtrl",["$scope","$location","Invit","WX",function(a,b,c,d){a.share("未见旅游-邀请得券","关注未见旅游，领取优惠券","","http://www.techmars.net/weijian/#/app"),window.location.href.indexOf("inv_code=")>-1?c.getProfileByInvitCode(window.location.href.split("inv_code=")[1]).then(function(b){a.invite=b.data}):a.execute(function(){c.getInvitCode().then(function(b){a.invite=b.data,d.getWX({url:window.location.href.split("#")[0]}).then(function(b){var c=b.data;c.jsApiList=["onMenuShareTimeline","onMenuShareAppMessage","onMenuShareQQ","onMenuShareWeibo","onMenuShareQZone"],wx.config(c),a.share("未见旅游-邀请得券","我是"+a.invite.sender+"这是我的未见邀请码，关注“未见”后填写我的邀请码可以领取20元旅游代金券哦","",window.location.href+"?inv_code="+a.invite.inv_code)})})},"//#/app/invite/list")}]),angular.module("WeiJianApp").config(["$stateProvider",function(a){a.state("app.reward",{"abstract":!0,url:"/reward",templateUrl:"views/reward/main.html",controller:"RewardCtrl"}).state("app.reward.list",{url:"/list",templateUrl:"views/reward/list.html",controller:"RewardListCtrl"})}]).controller("RewardCtrl",["$scope","$state","Invit",function(a,b,c){a.daijinquan=!0,a.all_view=!1,a.execute(function(){c.yaoqingma({inv_code:"test"}).success(function(a,b,c,d){}).error(function(b,c,d,e){409==c&&(a.daijinquan=!1),a.all_view=!0})},"//#/app/reward/list")}]).controller("RewardListCtrl",["$scope","sweet","$state","Invit","$cookies",function(a,b,c,d,e){if(a.share("未见旅游-领取代金券","未见，未曾遇见过的美好"),a.setWeiXinTitle("领代金券"),!e.get("token")){var f=f||window.location.href;f.indexOf("token=")>-1&&(f=f.replace("token="+$location.search().token,"")),f=f.split("/#/app/")[1].replace(/\//g,"OO"),location.href="https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx7ddd028c2621995d&redirect_uri=http://www.techmars.net/api/v1/wxauth&response_type=code&scope=snsapi_base&state="+f}a.showAlert=function(e){a.execute(function(){d.yaoqingma({inv_code:e}).success(function(a,b,d,e){c.go("app.vouchers.list"),console.log(a)}).error(function(c,d,e,f){409!=d&&alert("报错码:"+d+c);var g="验证码错误";return 409==d?void(a.daijinquan=!1):void b.show({title:g,type:"error",showConfirmButton:!1,timer:2e3})})},"//#/app/reward/list")}}]),angular.module("WeiJianApp").config(["$stateProvider",function(a){a.state("app.vouchers",{"abstract":!0,url:"/vouchers",templateUrl:"views/vouchers/main.html",controller:"VouchersCtrl"}).state("app.vouchers.list",{url:"/list",templateUrl:"views/vouchers/list.html",controller:"VouchersListCtrl"})}]).controller("VouchersCtrl",function(){}).controller("VouchersListCtrl",["$scope","User",function(a,b){a.share("未见旅游-领取代金券","未见，未曾遇见过的美好"),a.setWeiXinTitle("领代金券"),a.execute(function(){b.getUser().then(function(b){a.user=b.data,console.log(b.data)})},"//#/app/vouchers/list")}]),angular.module("WeiJianApp").config(["$stateProvider",function(a){a.state("app.rule",{"abstract":!0,url:"/rule",templateUrl:"views/rule/main.html",controller:"RuleCtrl"}).state("app.rule.list",{url:"/list",templateUrl:"views/rule/list.html",controller:"RuleListCtrl"})}]).controller("RuleCtrl",function(){}).controller("RuleListCtrl",["$scope",function(a){a.share("未见旅游-领取代金券","未见，未曾遇见过的美好"),a.setWeiXinTitle("活动规则")}]),angular.module("WeiJianApp").config(["$stateProvider",function(a){a.state("app.information",{"abstract":!0,url:"/information",templateUrl:"views/information/main.html",controller:"InformationCtrl"}).state("app.information.list",{url:"/list",templateUrl:"views/information/list.html",controller:"InformationListCtrl"})}]).controller("InformationCtrl",function(){}).controller("InformationListCtrl",["$scope","$cookies","sweet","Order","$state","User",function(a,b,c,d,e,f){a.share("未见旅游","未见，未曾遇见过的美好"),a.setWeiXinTitle("提交订单"),a.shipping_address={};var g=angular.fromJson(b.get("o"));g.shipping_address&&(a.shipping_address=g.shipping_address),a.execute(function(){f.getUser().then(function(b){console.log(b.data),a.shipping_address=b.data})}),a.placeOrder=function(){return a.shipping_address.name?a.shipping_address.phone?a.shipping_address.email?a.shipping_address.phone.length<7||a.shipping_address.phone.length>15?void a.showHint("电话"):a.shipping_address.email.match("^([a-z0-9A-Z]+[-|_|\\.]?)+[a-z0-9A-Z]@([a-z0-9A-Z]+(-[a-z0-9A-Z]+)?\\.)+[a-zA-Z]{2,}$")?(g.shipping_address=a.shipping_address,b.put("o",JSON.stringify(g)),void a.execute(function(){var c=angular.fromJson(b.get("o_params"));console.log(c),f.updateUser(a.shipping_address).then(function(a){d.createOrder(c).then(function(a){b.put("oid",a.data.order_num),console.log(a.data),e.go("app.pay.list",{order_id:a.data.order_num})})})})):void a.showHint("邮箱"):void a.showAlert("邮箱"):void a.showAlert("电话"):void a.showAlert("姓名")},a.showAlert=function(a){c.show({title:"请完成预订人信息",text:a+"没有输入哟！",type:"error",confirmButtonText:"确认"})},a.showHint=function(a){c.show({title:"请完成预订人信息",text:a+"的格式不正确诶！",type:"error",confirmButtonText:"确认"})}}]),angular.module("WeiJianApp").config(["$stateProvider",function(a){a.state("app.sb",{"abstract":!0,url:"/sb",templateUrl:"views/sb/main.html",controller:"SbCtrl"}).state("app.sb.list",{url:"/list",templateUrl:"views/sb/list.html",controller:"SbListCtrl"})}]).controller("SbCtrl",function(){}).controller("SbListCtrl",["$scope","$cookies",function(a,b){a.token=b.get("token")}]),angular.module("WeiJianApp").factory("AppAuth",["$cookies",function(a){return{currentUser:null,ensureHasCurrentUser:function(b){this.currentUser?console.log("Using cached current user."):(console.log("Fetching current user from the server."),null!=a.token&&null!=a.key?this.currentUser={name:a.name,token:a.token,key:a.key,avatar:"http://7sbqrd.com2.z0.glb.clouddn.com/avatar.png-avatarhd"}:this.currentUser=!1)}}}]),angular.module("WeiJianApp").service("ATHttpService",["$http","md5","base64","$cookies","$ionicPopup","ENV","sweet",function(a,b,c,d,e,f,g){this.authorization=function(a){return d.get("token")},this.http=function(b,c,g){var h=this.authorization(JSON.stringify(g));return a({method:b,url:f.apiUrl+c,data:g,headers:{Accept:"application/json",Authorization:h}}).success(function(a,b,c,d){}).error(function(a,b,c,g){if(console.log("ERROR_STATUS:"+b+a),f.isDebug&&(409==b||e.alert({title:"对不起，似乎遇到了一些问题...",template:"错误码: "+b+" 错误原因: "+a})),401==b)if(d.remove("token"),d.remove("openid"),f.isDebug)d.put("token",f.fake_token),location.href=window.location.href;else{var h=window.location.href.split("/#/app/")[1].replace(/\//g,"OO");location.href="https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx7ddd028c2621995d&redirect_uri=http://www.techmars.net/api/v1/wxauth&response_type=code&scope=snsapi_base&state="+h}})},this.get=function(a){return this.http("GET",a,"{}")},this.post=function(a,b){return this.http("POST",a,b)},this.put=function(a,b){return this.http("PUT",a,b)},this["delete"]=function(a,b){return null==b&&(b="{}"),this.http("DELETE",a,b)}}]),angular.module("WeiJianApp").service("Token",["ATHttpService","$q","$http","ENV",function(a,b,c,d){this.getToken=function(b){return a.post("/v1/tmauth",b).success(function(a,b,c,d){return a})}}]),angular.module("WeiJianApp").service("Banner",["ATHttpService","$q",function(a,b){this.getBanners=function(){return a.get("/v1/banners/").success(function(a,b,c,d){return a})}}]),angular.module("WeiJianApp").service("HomeCard",["ATHttpService","$q",function(a,b){this.getHomeCards=function(){return a.get("/v1/home_cards/").success(function(a,b,c,d){return a})}}]),angular.module("WeiJianApp").service("Product",["ATHttpService","$q",function(a,b){this.product=null,this.select_types=[{type_name:"产品类型",type_value:"p_types",select_switch:!1,title:"产品类型",total:0},{type_name:"出发地",type_value:"sources",select_switch:!1,title:"出发地",total:0},{type_name:"目的地",type_value:"destinations",select_switch:!1,title:"目的地",total:0},{type_name:"出发时间",type_value:"departure_time",select_switch:!1,title:"出发时间",total:0}],this.getItems=function(b){return a.get("/v1/items?type="+b).success(function(a,b,c,d){return a})}}]),angular.module("WeiJianApp").service("User",["ATHttpService","$q","$cookies","$location",function(a,b,c,d){this.createUser=function(b){return a.put("/v1/user",b).success(function(a,b,c,d){return a})},this.getUser=function(){return a.get("/v1/user").success(function(a,b,c,d){return a})},this.updateUser=function(b){return a.post("/v1/user",b).success(function(a,b,c,d){return a})}}]),angular.module("WeiJianApp").service("Item",["ATHttpService","$q",function(a,b){this.getItemById=function(b){return a.get("/v1/item?pid="+b).success(function(a,b,c,d){return a})}}]),angular.module("WeiJianApp").service("Cart",["ATHttpService","$q",function(a,b){}]),angular.module("WeiJianApp").service("Order",["ATHttpService","$q",function(a,b){this.createOrder=function(b){return a.put("/v1/order",b).success(function(a,b,c,d){return a})},this.getOrders=function(){return a.get("/v1/orders").success(function(a,b,c,d){return a})}}]),angular.module("WeiJianApp").service("Invit",["ATHttpService","$q",function(a,b){this.getInvitCode=function(b){return a.put("/v1/invit").success(function(a,b,c,d){return a})},this.getProfileByInvitCode=function(b){return a.get("/v1/invit?inv_code="+b).success(function(a,b,c,d){return a})},this.receiveInvitCode=function(b){return a.post("/v1/invit").success(function(a,b,c,d){return a})},this.yaoqingma=function(b){return a.post("/v1/invit",b).success(function(a,b,c,d){return a})}}]),angular.module("WeiJianApp").service("Bound",["ATHttpService","$q",function(a,b){this.getBounds=function(){return a.get("/v1/cprecords").success(function(a,b,c,d){return a})}}]),angular.module("WeiJianApp").service("Pay",["ATHttpService","$q",function(a,b){this.getWXQRcode=function(b){return a.get("/v1/wxqr?trade_no="+b+"&result=url").success(function(a,b,c,d){return a})}}]),angular.module("WeiJianApp").service("WX",["ATHttpService","$q",function(a,b){this.getWX=function(b){return a.post("/v1/jsconf",b).success(function(a,b,c,d){return a})}}]);